\section{Teori}
Jorda er omsluttet av et magnetfelt, som kan tilnærmes med en 
dipolorientert omtrent i flukt med rotasjonsaksen. Jordas magnetiske sørpol 
befinner seg i nærheten av jordas geografiske nordpol, og magnetisk nordpol 
befinner seg i nærheten av geografisk sørpol. Presiseringen "i nærheten av" 
er således viktig i forbindelse med dette prosjektet, ettersom dette gir 
opphav til fenomentet deklinasjon. Et kompass vil peke mot den magnetiske sørpolen og ikke mot den geografiske nordpolen.
Denne misvisningen kalles deklinasjon og blir oppgitt som vinkelen mellom 
geografisk nord og retningen på magnetfeltet. På grunn av asymmetrien til 
de magnetiske polene i forhold til rotasjonsaksen, vil deklinasjonen 
variere og være avhengig av posisjonen på jorda. \cite{World_magnetic_model}

Et annet fenomen er inklinasjon som beskriver hvor mye magnetfeltet peker 
nedover i forhold til horisontalplanet. Ettersom magnetfeltlinjene ikke følger jordas overflate vil 
magnetfeltet peke nedover mot bakken. Inklinasjonen 
blir derfor oppgitt som den vertikale vinkelen mellom tangentplanet til jorda og
magnetfeltet.

\subsection{Phyphox}
Phyphox er en app man kan laste ned på telefonen sin, som lar brukeren 
bruke telefonen sine sensorer til å foreta ulike målinger. Deriblant finnes 
det et magnetometer som lar en måle magnetfelt-styrken langs alle 
koordinataksene til telefonen, i tillegg til absolutt feltstyrke. 
Se https://phyphox.org/ \cite{phyphox} for mer informasjon om sensorer og koordinatsystemet til telefonen.

\subsection{Hvordan måle inklinasjonen}
For å måle inklinasjonen, trenger en kun å finne magnetfelt-styrken i horisontal-
planet og i vertikal retning. Da blir formelen for inklinasjonen 
\begin{equation}
    \gamma = \arctan \frac{-B_z}{B_H}
\end{equation}
hvor $B_z$ er feltstyrken i z-retning, og $B_H$ er feltstyrken i horisontalplanet. 
Minustegnet foran $B_z$ kommer av at $B_z$ vil være en negativ størrelse, mens inklinasjon blir oppgitt som en positiv størrelse. Når en foretar målingene ved hjelp av 
phyphox får man derimot ikke feltstyrken i planet eksplisitt, men i komponentform i 
x- og y-retning. Formelen som kommer til å brukes blir dermed
\begin{equation}
    \gamma = \arctan{ \frac{-B_z}{\sqrt{B_x^2 + B_y^2}} }
\end{equation}
hvor $B_x$ og $B_y$ er henholdsvis magnetfeltstyrken i x- og y-retning.

\subsection{Hvordan måle deklinasjonen}
For å finne ut deklinasjonen kreves det at man vet hvor både magnetisk sørpol og 
geografisk nordpol er, for så å kunne regne ut vinkelen mellom dem. For å oppnå dette 
kan det benyttes et mellomsteg, et fast referansepunkt, som man relaterer både 
magnetfeltet og geografisk nord til. Hvis man så finner vinkelen mellom magnetfeltet 
og referansepunktet, og geografisk nord og referansepunktet, kan deklinasjonen 
regnes ut basert på dette. Gitt vinklene ovenfor blir deklinasjonen
\begin{equation}
    \alpha = \beta - \theta
\end{equation}
hvor $\beta$ er vinkelen mellom referansepunktet og magnetfeltet, og $\theta$ er 
vinkelen mellom referansepunktet og geografisk nord.

\subsubsection{Vinkel mellom referansepunkt og magnetfelt, burde kanskje skrives om}
Vinkelen mellom referansepunktet og magnetfeltet kan bli funnet ved å sette opp 
telefonen sitt koordinatsystem slik at vinkelen mellom det og referansepunktet er 
kjent når en tar målingene. Gitt dette oppsettet blir vinkelen mellom magnetfeltet 
og koordinatsystemet
\begin{equation}
    \phi = \arctan \frac{B_y}{B_x}
\end{equation}
og dermed mellom referansepunktet og magnetfeltet
\begin{equation}
    \beta = \psi - \phi = \psi - \arctan \frac{B_y}{B_x}
\end{equation}
hvor $\psi$ er vinkelen mellom referansepunktet og koordinatsystemet.

\subsubsection{Posisjon Nidarosdomen, Tyholt}

\subsubsection{Vinkel mellom referansepunkt og nord}

For å finne vinkler på jordoverflaten brukes en ellipsoidisk modell av jorden.
WGS-84 (World Geodetic System) sin referanseellipsoide blir brukt i denne rapporten.
Vinkelen mellom meridianen (linje fra geografisk nordpol til geografisk sørpol) gjennom målelokasjonen og 
kurven fra målelokasjonen til referansepunktet kalles asimut \cite{asimut} og gis ofte symbolet $\alpha$ (se figur \ref{fig:inverse_problem}).
Problemet man står ovenfor da er:
\\

Finn asimuten $\alpha_1$ gitt to punkter på jordoverflaten $(\varphi_1, \lambda_1, )$ og $(\varphi_2, \lambda_2)$, hvor $\varphi$ er breddegradene og $\lambda$ er lengdegradene. 
\\

Dette problemet blir kalt \textbf{Inverse Problem} i \textit{Algorithms for geodesics} (2013) \cite{Karney}. Karney presenterer en metode for å løse slike problemer. Python-biblioteket geographiclib implementerer denne; funksjonen \kode{geodesic.Geodesic.WGS84.Inverse()} tar inn to punkter og løser for geodetisk avstand samt de to asimutene \cite{geographiclib} (se figur \ref{fig:inverse_problem}).

\begin{figure}
    \centering
    \includegraphics[width=0.75\textwidth]{img/angle_north.pdf}
    \caption{Koordinatene til $B$ og $C$ blir estimert ved hjelp av Google Maps. 
    Koordinatene til målelokasjonen $A$ ble målt ved hjelp av Phyphox \cite{phyphox}.
    $\theta_1$ og $\theta_2$ er vinklene mellom hhv. spiret på Nidarosdomen og geografisk nord, og mellom Tyholttårnet og geografisk nord.}
    \label{fig:angle_north}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.75\textwidth]{img/ellipsoidal_problem.pdf}
    \caption{Vinkelen vi er ute etter er $\alpha_1$. Gitt to punkter på overflaten av den ellipsoidiske modellen av jordkloden gir algoritmen til Karney \cite{Karney} den geodetiske avstanden $s_{12}$ og de to asimutene $\alpha_1$ og $\alpha_2$.}
    \label{fig:inverse_problem}
\end{figure}
